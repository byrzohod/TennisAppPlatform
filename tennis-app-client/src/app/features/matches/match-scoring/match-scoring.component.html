<div class="min-h-screen bg-gradient-to-br from-grass-50 to-grass-100 dark:from-gray-900 dark:to-gray-800 p-4">
  <div class="max-w-7xl mx-auto">
    <!-- Match Header -->
    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 mb-6">
      <div class="flex items-center justify-between mb-4">
        <div>
          <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Live Match Scoring</h1>
          <p class="text-gray-600 dark:text-gray-400">{{ match.tournament }} • {{ match.round }}</p>
        </div>
        <div class="flex items-center gap-4">
          <app-badge [variant]="'info'" class="px-4 py-2">
            <span class="flex items-center gap-2">
              <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
              LIVE
            </span>
          </app-badge>
          <span [class]="getSurfaceColor()" class="px-3 py-1 rounded-full text-sm font-medium">
            {{ match.surface }}
          </span>
        </div>
      </div>

      <!-- Match Info Bar -->
      <div class="grid grid-cols-3 gap-4 p-4 bg-gray-50 dark:bg-gray-900 rounded-lg">
        <div class="text-center">
          <p class="text-sm text-gray-500 dark:text-gray-400">Court</p>
          <p class="font-semibold text-gray-900 dark:text-white">{{ match.court }}</p>
        </div>
        <div class="text-center">
          <p class="text-sm text-gray-500 dark:text-gray-400">Duration</p>
          <p class="font-semibold text-gray-900 dark:text-white">{{ formatDuration(matchDuration) }}</p>
        </div>
        <div class="text-center">
          <p class="text-sm text-gray-500 dark:text-gray-400">Status</p>
          <p class="font-semibold text-grass-600 dark:text-grass-400">
            @if (score.winner) {
              Match Complete
            } @else if (isPaused) {
              Paused
            } @else {
              In Progress
            }
          </p>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Tennis Court Visualization -->
      <div class="lg:col-span-2">
        <app-card>
          <div class="p-6">
            <h2 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Court View</h2>
            
            <!-- Score Board -->
            <div class="bg-gradient-to-r from-grass-600 to-grass-700 rounded-lg p-6 mb-6 text-white">
              <div class="grid grid-cols-3 gap-4">
                <!-- Player 1 -->
                <div class="text-left">
                  <div class="flex items-center gap-2 mb-2">
                    <span class="text-2xl">{{ getServerIndicator(1) }}</span>
                    <div>
                      <p class="font-bold text-lg">{{ match.player1.name }}</p>
                      <p class="text-sm opacity-80">Rank #{{ match.player1.ranking }}</p>
                    </div>
                  </div>
                </div>

                <!-- Score -->
                <div class="text-center">
                  <div class="flex justify-center gap-4 mb-2">
                    <!-- Sets -->
                    @for (set of score.sets; track $index) {
                      <div class="bg-white/20 rounded px-3 py-1">
                        <span class="text-xl font-bold">{{ set.player1Games }}</span>
                      </div>
                    }
                    <!-- Current Game -->
                    <div class="bg-white/30 rounded px-3 py-1 border-2 border-white">
                      <span class="text-xl font-bold">
                        {{ getGameScoreDisplay(score.currentGame.player1, score.currentGame.player2) }}
                      </span>
                    </div>
                  </div>
                </div>

                <!-- Match Status -->
                <div class="text-right">
                  <p class="text-sm opacity-80">Sets</p>
                  <p class="text-3xl font-bold">{{ score.player1Sets }}</p>
                </div>
              </div>

              <div class="border-t border-white/30 my-4"></div>

              <div class="grid grid-cols-3 gap-4">
                <!-- Player 2 -->
                <div class="text-left">
                  <div class="flex items-center gap-2">
                    <span class="text-2xl">{{ getServerIndicator(2) }}</span>
                    <div>
                      <p class="font-bold text-lg">{{ match.player2.name }}</p>
                      <p class="text-sm opacity-80">Rank #{{ match.player2.ranking }}</p>
                    </div>
                  </div>
                </div>

                <!-- Score -->
                <div class="text-center">
                  <div class="flex justify-center gap-4">
                    <!-- Sets -->
                    @for (set of score.sets; track $index) {
                      <div class="bg-white/20 rounded px-3 py-1">
                        <span class="text-xl font-bold">{{ set.player2Games }}</span>
                      </div>
                    }
                    <!-- Current Game -->
                    <div class="bg-white/30 rounded px-3 py-1 border-2 border-white">
                      <span class="text-xl font-bold">
                        {{ getGameScoreDisplay(score.currentGame.player2, score.currentGame.player1) }}
                      </span>
                    </div>
                  </div>
                </div>

                <!-- Match Status -->
                <div class="text-right">
                  <p class="text-sm opacity-80">Sets</p>
                  <p class="text-3xl font-bold">{{ score.player2Sets }}</p>
                </div>
              </div>
            </div>

            <!-- Tennis Court SVG -->
            <div class="relative bg-grass-500 rounded-lg p-4 aspect-[2/1]">
              <svg viewBox="0 0 400 200" class="w-full h-full">
                <!-- Court Lines -->
                <rect x="10" y="10" width="380" height="180" fill="none" stroke="white" stroke-width="2"/>
                <!-- Service boxes -->
                <line x1="10" y1="100" x2="390" y2="100" stroke="white" stroke-width="2"/>
                <line x1="100" y1="10" x2="100" y2="190" stroke="white" stroke-width="1"/>
                <line x1="300" y1="10" x2="300" y2="190" stroke="white" stroke-width="1"/>
                <line x1="200" y1="40" x2="200" y2="160" stroke="white" stroke-width="1"/>
                <!-- Singles sidelines -->
                <line x1="30" y1="10" x2="30" y2="190" stroke="white" stroke-width="1"/>
                <line x1="370" y1="10" x2="370" y2="190" stroke="white" stroke-width="1"/>
                
                <!-- Players positions -->
                @if (!score.winner) {
                  <!-- Player 1 (bottom) -->
                  <circle cx="200" cy="170" r="8" fill="#FFD700" stroke="white" stroke-width="2">
                    <animate attributeName="cy" values="170;165;170" dur="2s" repeatCount="indefinite"/>
                  </circle>
                  <text x="200" y="175" text-anchor="middle" fill="black" font-size="10" font-weight="bold">P1</text>
                  
                  <!-- Player 2 (top) -->
                  <circle cx="200" cy="30" r="8" fill="#C0C0C0" stroke="white" stroke-width="2">
                    <animate attributeName="cy" values="30;35;30" dur="2s" repeatCount="indefinite"/>
                  </circle>
                  <text x="200" y="35" text-anchor="middle" fill="black" font-size="10" font-weight="bold">P2</text>
                  
                  <!-- Ball -->
                  <circle cx="200" cy="100" r="4" fill="yellow" stroke="black" stroke-width="1">
                    <animateTransform attributeName="transform" type="rotate" from="0 200 100" to="360 200 100" dur="1s" repeatCount="indefinite"/>
                  </circle>
                }
              </svg>
            </div>

            <!-- Scoring Controls -->
            <div class="mt-6 space-y-4">
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <p class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    {{ match.player1.name }} scores:
                  </p>
                  <div class="grid grid-cols-3 gap-2">
                    <app-button (click)="scorePoint(1, 'ace')" [variant]="'primary'" size="sm">
                      Ace
                    </app-button>
                    <app-button (click)="scorePoint(1, 'winner')" [variant]="'primary'" size="sm">
                      Winner
                    </app-button>
                    <app-button (click)="scorePoint(1, 'forced-error')" [variant]="'secondary'" size="sm">
                      Forced Error
                    </app-button>
                  </div>
                </div>
                
                <div>
                  <p class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    {{ match.player2.name }} scores:
                  </p>
                  <div class="grid grid-cols-3 gap-2">
                    <app-button (click)="scorePoint(2, 'ace')" [variant]="'primary'" size="sm">
                      Ace
                    </app-button>
                    <app-button (click)="scorePoint(2, 'winner')" [variant]="'primary'" size="sm">
                      Winner
                    </app-button>
                    <app-button (click)="scorePoint(2, 'forced-error')" [variant]="'secondary'" size="sm">
                      Forced Error
                    </app-button>
                  </div>
                </div>
              </div>

              <!-- Match Controls -->
              <div class="flex justify-center gap-2 pt-4 border-t">
                <app-button (click)="undoLastPoint()" [variant]="'outline'" size="sm">
                  <span class="flex items-center gap-1">
                    ↶ Undo
                  </span>
                </app-button>
                <app-button (click)="togglePause()" [variant]="isPaused ? 'primary' : 'secondary'" size="sm">
                  {{ isPaused ? '▶ Resume' : '⏸ Pause' }}
                </app-button>
                <app-button (click)="endMatch()" [variant]="'outline'" size="sm" class="text-red-600">
                  End Match
                </app-button>
              </div>
            </div>
          </div>
        </app-card>
      </div>

      <!-- Point History & Stats -->
      <div class="space-y-6">
        <!-- Match Statistics -->
        <app-card>
          <div class="p-6">
            <h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white">Match Statistics</h3>
            
            <div class="space-y-3">
              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-gray-600 dark:text-gray-400">Aces</span>
                  <span class="font-medium">5 - 3</span>
                </div>
                <div class="relative h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                  <div class="absolute left-0 top-0 h-full bg-grass-500" style="width: 62.5%"></div>
                </div>
              </div>

              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-gray-600 dark:text-gray-400">Winners</span>
                  <span class="font-medium">12 - 8</span>
                </div>
                <div class="relative h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                  <div class="absolute left-0 top-0 h-full bg-grass-500" style="width: 60%"></div>
                </div>
              </div>

              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-gray-600 dark:text-gray-400">Unforced Errors</span>
                  <span class="font-medium">6 - 9</span>
                </div>
                <div class="relative h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                  <div class="absolute left-0 top-0 h-full bg-clay-500" style="width: 40%"></div>
                </div>
              </div>

              <div>
                <div class="flex justify-between text-sm mb-1">
                  <span class="text-gray-600 dark:text-gray-400">1st Serve %</span>
                  <span class="font-medium">68% - 71%</span>
                </div>
                <div class="relative h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                  <div class="absolute left-0 top-0 h-full bg-hard-500" style="width: 49%"></div>
                </div>
              </div>
            </div>
          </div>
        </app-card>

        <!-- Point History -->
        <app-card>
          <div class="p-6">
            <h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white">Point History</h3>
            
            <div class="space-y-2 max-h-96 overflow-y-auto">
              @for (point of pointHistory; track $index) {
                <div class="flex items-center justify-between p-2 rounded-lg bg-gray-50 dark:bg-gray-900">
                  <div class="flex items-center gap-2">
                    <span class="text-2xl">
                      {{ point.server === 1 ? '🎾' : '🏐' }}
                    </span>
                    <div>
                      <p class="text-sm font-medium text-gray-900 dark:text-white">
                        {{ point.scorer === 1 ? match.player1.name : match.player2.name }}
                      </p>
                      <p class="text-xs text-gray-500">{{ point.type }}</p>
                    </div>
                  </div>
                  <div class="text-right">
                    <p class="text-sm font-bold text-gray-900 dark:text-white">{{ point.score }}</p>
                    <p class="text-xs text-gray-500">{{ point.timestamp | date:'HH:mm:ss' }}</p>
                  </div>
                </div>
              } @empty {
                <p class="text-center text-gray-500 dark:text-gray-400 py-4">
                  No points scored yet
                </p>
              }
            </div>
          </div>
        </app-card>
      </div>
    </div>
  </div>
</div>