<div class="player-detail-container">
  @if (loading) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Loading player details...</p>
    </div>
  }

  @if (error) {
    <div class="error-message">
      <span class="error-icon">‚ö†Ô∏è</span>
      {{ error }}
      <a routerLink="/players" class="btn btn-secondary">Back to Players</a>
    </div>
  }

  @if (player && !loading) {
    <!-- Header -->
    <div class="player-header">
      <div class="header-content">
        <div class="player-avatar">
          @if (player.profileImageUrl) {
            <img [src]="player.profileImageUrl" [alt]="player.firstName + ' ' + player.lastName">
          } @else {
            <div class="avatar-placeholder">
              {{ player.firstName[0] }}{{ player.lastName[0] }}
            </div>
          }
        </div>
        
        <div class="player-info">
          <h1>{{ player.firstName }} {{ player.lastName }}</h1>
          <div class="player-badges">
            @if (player.currentRanking) {
              <span class="ranking-badge">Ranking #{{ player.currentRanking }}</span>
            }
            <span class="points-badge">{{ player.rankingPoints }} Points</span>
          </div>
        </div>
      </div>

      <div class="header-actions">
        <a [routerLink]="['/players', player.id, 'edit']" class="btn btn-primary">
          <span class="icon">‚úèÔ∏è</span>
          Edit Player
        </a>
        <button (click)="deletePlayer()" class="btn btn-danger">
          <span class="icon">üóëÔ∏è</span>
          Delete
        </button>
      </div>
    </div>

    <!-- Content Grid -->
    <div class="content-grid">
      <!-- Personal Information -->
      <div class="info-card">
        <h2>Personal Information</h2>
        <div class="info-grid">
          <div class="info-item">
            <label for="player-email">Email</label>
            <span id="player-email">{{ player.email }}</span>
          </div>
          <div class="info-item">
            <label for="player-phone">Phone</label>
            <span id="player-phone">{{ player.phone || 'Not provided' }}</span>
          </div>
          <div class="info-item">
            <label for="player-dob">Date of Birth</label>
            <span id="player-dob">{{ formatDate(player.dateOfBirth) }}</span>
          </div>
          <div class="info-item">
            <label for="player-age">Age</label>
            <span id="player-age">{{ getAge(player.dateOfBirth) }} years</span>
          </div>
          <div class="info-item">
            <label for="player-member-since">Member Since</label>
            <span id="player-member-since">{{ formatDate(player.createdAt) }}</span>
          </div>
          <div class="info-item">
            <label for="player-last-updated">Last Updated</label>
            <span id="player-last-updated">{{ formatDate(player.updatedAt) }}</span>
          </div>
        </div>
      </div>

      <!-- Statistics -->
      <div class="stats-card">
        <h2>Statistics</h2>
        <div class="stats-grid">
          <div class="stat-item">
            <span class="stat-value">{{ player.rankingPoints }}</span>
            <span class="stat-label">Ranking Points</span>
          </div>
          <div class="stat-item">
            <span class="stat-value">
              @if (player.currentRanking) {
                #{{ player.currentRanking }}
              } @else {
                N/A
              }
            </span>
            <span class="stat-label">Current Ranking</span>
          </div>
          <div class="stat-item">
            <span class="stat-value">12</span>
            <span class="stat-label">Matches Played</span>
          </div>
          <div class="stat-item">
            <span class="stat-value">75%</span>
            <span class="stat-label">Win Rate</span>
          </div>
        </div>
      </div>

      <!-- Recent Matches -->
      <div class="matches-card">
        <h2>Recent Matches</h2>
        <div class="matches-list">
          @for (match of recentMatches; track match.date) {
            <div class="match-item">
              <div class="match-result" [class.won]="match.result === 'Won'" [class.lost]="match.result === 'Lost'">
                {{ match.result }}
              </div>
              <div class="match-details">
                <div class="match-opponent">vs {{ match.opponent }}</div>
                <div class="match-score">{{ match.score }}</div>
              </div>
              <div class="match-date">{{ match.date }}</div>
            </div>
          }
        </div>
        <a href="#" class="view-all-link">View All Matches ‚Üí</a>
      </div>

      <!-- Tournaments -->
      <div class="tournaments-card">
        <h2>Tournaments</h2>
        <div class="tournaments-list">
          @for (tournament of tournaments; track tournament.name) {
            <div class="tournament-item">
              <div class="tournament-name">{{ tournament.name }}</div>
              <div class="tournament-info">
                <span class="tournament-status" [class.registered]="tournament.status === 'Registered'"
                      [class.completed]="tournament.status === 'Completed'">
                  {{ tournament.status }}
                </span>
                @if (tournament.position) {
                  <span class="tournament-position">Position: {{ tournament.position }}</span>
                }
                <span class="tournament-date">{{ tournament.startDate }}</span>
              </div>
            </div>
          }
        </div>
        <a href="#" class="view-all-link">View All Tournaments ‚Üí</a>
      </div>
    </div>

    <!-- Back Button -->
    <div class="bottom-actions">
      <a routerLink="/players" class="btn btn-secondary">
        <span class="icon">‚Üê</span>
        Back to Players
      </a>
    </div>
  }
</div>